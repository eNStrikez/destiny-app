"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var fs = require("fs");
var sqlite = require("sqlite3");
/**
 * Class for accessing the manifest file. You will need to install <strong>sqlite3</strong> to use this class.
 */
var Manifest = /** @class */ (function () {
    function Manifest(filepath) {
        if (fs.existsSync(filepath)) {
            this.filepath = filepath;
            this.db = new sqlite.Database(filepath);
        }
        else {
            throw new Error('The manifest file you want to refer to does not exist. Consider downloading it at first with Traveler#downloadManifest.');
        }
    }
    /**
     * Query the manifest file with a valid SQlite query
     * @async
     * @param sqlLiteQuery SQlite valid query
     * @return {Promise<object>} When fulfilled returns an object containing the result of the query
     */
    Manifest.prototype.queryManifest = function (sqlLiteQuery) {
        var _this = this;
        return new Promise(function (resolve, reject) {
            _this.db.serialize(function () {
                _this.db.all(sqlLiteQuery, function (err, row) {
                    if (err) {
                        reject(err);
                    }
                    else {
                        resolve(row);
                    }
                });
            });
        });
    };
    return Manifest;
}());
exports.default = Manifest;
